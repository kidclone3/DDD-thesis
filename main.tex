% \PassOptionsToPackage{unicode}{hyperref}
% \PassOptionsToPackage{hyphens}{url}
% \PassOptionsToPackage{dvipsnames,svgnames,x11names,table}{xcolor}
\documentclass[fontsize=14pt,DIV=15pt,twoside=false]{scrbook}
% Fix old font command bugs
\DeclareOldFontCommand{\rm}{\normalfont\rmfamily}{\mathrm}
\DeclareOldFontCommand{\sf}{\normalfont\sffamily}{\mathsf}
\DeclareOldFontCommand{\tt}{\normalfont\ttfamily}{\mathtt}
\DeclareOldFontCommand{\bf}{\normalfont\bfseries}{\mathbf}
\DeclareOldFontCommand{\it}{\normalfont\itshape}{\mathit}
\DeclareOldFontCommand{\sl}{\normalfont\slshape}{\@nomath\sl}
\DeclareOldFontCommand{\sc}{\normalfont\scshape}{\@nomath\sc}
\DeclareOldFontCommand{\sfb}{\normalfont\sffamily\bfseries}{\@nomath\sfb}

\usepackage{geometry}
\geometry{a4paper,
    top=2.5cm,
    bottom=2.5cm,
    left=3cm,
    right=2.5cm,
}

\usepackage{amsthm} % For theorem, definition, etc.
\usepackage[at]{easylist}
\usepackage{amsthm}
\newtheorem{theorem}{Theorem} 
\newtheorem{corollary}{Corollary}
\newtheorem{lemma}{Lemma}
\newtheorem{definition}{Definition}
\newtheorem{proposition}{Proposition}

% For Vietnamese name of auto-references
\def\algorithmautorefname{Thuật toán}
\def\sectionautorefname{Chương}

% To mark the word and create a label for it
\makeatletter
\newcommand{\setword}[2]{%
  \phantomsection
  #1\def\@currentlabel{\unexpanded{#1}}\label{#2}%
}
\makeatother

\AtBeginDocument{%
\renewcommand{\figureautorefname}{Hình}
\renewcommand{\tableautorefname}{Bảng}
}

\usepackage{subcaption} % For subfigure

% vnthesis mới đã có phần package pseudocode.
% Nằm trong init.
% PSEUDO-CODE
\usepackage{algorithm}
\usepackage[noEnd=false,indLines=true]{algpseudocodex}

\newcommand{\And}{\textbf{and~}}
\newcommand{\Or}{\textbf{or~}}
\newcommand{\Xor}{\textbf{xor~}}
\newcommand{\Not}{\textbf{not~}}
\newcommand{\To}{\textbf{to~}}
\newcommand{\DownTo}{\textbf{downto~}}
\newcommand{\True}{\textbf{true~}}
\newcommand{\False}{\textbf{false~}}
\newcommand{\Input}{\item[\textbf{Input:}]}
\renewcommand{\Output}{\item[\textbf{Output:}]}
\newcommand{\Print}{\State \textbf{print~}}
\renewcommand{\Return}{\State \textbf{return~}}
% END PSEUDO-CODE.



% For include other files
\usepackage{subfiles} % Best loaded last in the preamble

\usepackage{iftex}

\usepackage[utf8]{vietnam}
\usepackage[vietnamese=nohyphenation]{hyphsubst}
\usepackage[utf8]{inputenc}
\usepackage[vietnamese]{babel}

% Biblo
\usepackage[style=numeric]{biblatex}
\addbibresource{refs.bib}
\usepackage{csquotes} % biblatex recommended

\usepackage{fontspec}
\usepackage{pifont}
\setmainfont{Times New Roman}[
    ]
\setmonofont{JetBrainsMono}[
        Path = jetbrains-mono/,
        Extension = .ttf,
        UprightFont = *-Regular,
        ItalicFont = *-Italic,
        BoldFont = *-Bold,
        BoldItalicFont = *-BoldItalic,
    ]
    
\usepackage{fontawesome5}
\usepackage{unicode-math}
\usepackage{amsmath}
\usepackage{utfsym}
\usepackage{pmboxdraw}

\usepackage{xcolor}
\definecolor{deepblue}{RGB}{0, 0, 112}
\definecolor{cyclamen}{RGB}{255, 145, 237}
\definecolor{bubblegum}{RGB}{255, 115, 232}
\definecolor{silver}{RGB}{208,208,208}

\usepackage{listings}
\lstset{
    aboveskip=5mm,
    belowskip=5mm,
    xleftmargin=1.5em,
    showstringspaces=false,
    columns=flexible,
    numbers=left,
    numberfirstline,
    stepnumber=5,
    numberstyle=\small\color{gray},
    keywordstyle=\bfseries\color{deepblue},
    commentstyle=\itshape\color{deepgreen},
    stringstyle=\color{bubblegum},
    emphstyle=\color{deepred},
    keepspaces=true,
    breaklines=true,
    breakatwhitespace=false,
    breakautoindent=true,
    frame=single,
    framesep=3mm,
    rulecolor=\color{silver},
    tabsize=2,
    texcl=true,
    captionpos=b
}

\usepackage[]{hyperref}
\usepackage{bookmark}
\hypersetup{
    colorlinks=true,
    linkcolor=black,
    filecolor=bubblegum,
    urlcolor=deepblue,
    pdftitle={Phương pháp rời rạc động giải các bài toán \\ tìm đường đi
có yếu tố thời gian},
}

% from pandoc
\newcommand{\passthrough}[1]{#1}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{\setlength{\itemsep}{\smallskipamount}\setlength{\parskip}{\smallskipamount}}
% definitions for citeproc citations

% end from pandoc

\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhf{}
\fancyhead[L]{\includegraphics[height=1cm,keepaspectratio]{logo/page-header-logo.png}} \fancyhead[R]{\small\leftmark} \fancyfoot[C]{\thepage}
\fancypagestyle{plain}{%
\fancyhf{}
\fancyhead[L]{\includegraphics[height=1cm,keepaspectratio]{logo/page-header-logo.png}} \fancyhead[R]{\small\leftmark} \fancyfoot[C]{\thepage}
}

\usepackage{titlesec}
\setcounter{tocdepth}{2}
\renewcommand{\baselinestretch}{1}
\usepackage{indentfirst}
\setlength{\parindent}{14pt}
\setlength{\parskip}{6pt}

\setcounter{secnumdepth}{4}
\renewcommand{\thechapter}{\arabic{chapter}}
\renewcommand{\thesection}{\thechapter.\arabic{section}}
\renewcommand{\thesubsection}{\thesection.\arabic{subsection}}
\renewcommand{\thesubsubsection}{\thesubsection.\arabic{subsubsection}}
\renewcommand{\paragraph}{\arabic{paragraph}}
\renewcommand{\subparagraph}{\alph{subparagraph}}
\titleformat{\chapter}
{\bfseries\fontsize{20}{20}\selectfont}
{\thechapter.}{1em}{}

\titleformat{\section}
{\bfseries\fontsize{18}{20}\selectfont}
{\thesection}{1em}{}

\titleformat{\subsection}
{\bfseries\fontsize{16}{18}\selectfont}
{\thesubsection}{1em}{}

\titleformat{\subsubsection}
{\passthrough{\lstinline!\\bfseries\\fontsize\{16\}\{16\}\\selectfont!}}
{\thesubsubsection}{1em}{}

\titleformat{\paragraph}
{\hspace{1em}\fontsize{14}{16}\selectfont\rmfamily}
{\paragraph}{1em}{}

\titleformat{\subparagraph}
{\hspace{2em}\fontsize{14}{16}\selectfont\rmfamily}
{\subparagraph}{1em}{}

\usepackage{footnotebackref}

%begin tables-vrules.lua
\usepackage{longtable,booktabs,array, multirow}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\setlength{\aboverulesep}{0pt}
\setlength{\belowrulesep}{0pt}
\renewcommand{\arraystretch}{1.3}
%end tables-vrules.lua


%begin tables-vrules.lua
\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\setlength{\aboverulesep}{0pt}
\setlength{\belowrulesep}{0pt}
\renewcommand{\arraystretch}{1.3}
%end tables-vrules.lua
\usepackage{multicol}
  \newlength{\currentparskip}

\usepackage{environ}
\NewEnviron{centerboxed}{
\makebox[\linewidth][c]{%
\begin{minipage}[t][0.9\textheight][t]{\linewidth}%
\BODY
\end{minipage}%
}%
}

\NewEnviron{sign}{
\hfill\begin{tabular}{c}
{\it Hà Nội, ngày 24 tháng 4 năm 2024}
\\ \BODY
\\ \\[1cm]
{\bf Bùi Khánh Duy}\\
\end{tabular}%
}

\newcommand{\toc}[0]{
\tableofcontents
\listoffigures
\listoftables
}

\usepackage{tikz}
\usetikzlibrary{calc}
\newcommand{\frontmatterthesisframe}[2]{
\begin{tikzpicture}[remember picture,overlay]
\centering
\ifnum#1=0
#2
\fi

\ifnum#1=1
\draw[blue!70!black,line width=4pt]
([xshift=-1.5cm,yshift=-2cm]current page.north east) coordinate (A)--
([xshift=3.5cm,yshift=-2cm]current page.north west) coordinate(B)--
([xshift=3.5cm,yshift=2cm]current page.south west) coordinate (C)--
([xshift=-1.5cm,yshift=2cm]current page.south east) coordinate(D)--cycle;
\draw
([xshift=-0.5cm,yshift=0.5cm]A)--
([xshift=0.5cm,yshift=0.5cm]B)--
([xshift=0.5cm,yshift=-0.5cm]B)--
([xshift=-0.5cm,yshift=-0.5cm]B)--
([xshift=-0.5cm,yshift=0.5cm]C)--
([xshift=0.5cm,yshift=0.5cm]C)--
([xshift=0.5cm,yshift=-0.5cm]C)--
([xshift=-0.5cm,yshift=-0.5cm]D)--
([xshift=-0.5cm,yshift=0.5cm]D)--
([xshift=0.5cm,yshift=0.5cm]D)--
([xshift=0.5cm,yshift=-0.5cm]A)--
([xshift=-0.5cm,yshift=-0.5cm]A)--
([xshift=-0.5cm,yshift=0.5cm]A);
\draw
([xshift=0.3cm,yshift=-0.3cm]A)--
([xshift=-0.3cm,yshift=-0.3cm]B)--
([xshift=-0.3cm,yshift=0.3cm]B)--
([xshift=0.3cm,yshift=0.3cm]B)--
([xshift=0.3cm,yshift=-0.3cm]C)--
([xshift=-0.3cm,yshift=-0.3cm]C)--
([xshift=-0.3cm,yshift=0.3cm]C)--
([xshift=0.3cm,yshift=0.3cm]D)--
([xshift=0.3cm,yshift=-0.3cm]D)--
([xshift=-0.3cm,yshift=-0.3cm]D)--
([xshift=-0.3cm,yshift=0.3cm]A)--
([xshift=0.3cm,yshift=0.3cm]A)--
([xshift=0.3cm,yshift=-0.3cm]A);
\fi

\ifnum#1=2
\draw [line width=2pt]
([xshift=3.5cm,yshift=-2.5cm]current page.north west)
rectangle
([xshift=-2cm,yshift=2.5cm]current page.south east);
\draw [line width=0.5pt]
([xshift=3.6cm,yshift=-2.6cm]current page.north west)
rectangle
([xshift=-2.1cm,yshift=2.6cm]current page.south east);
\fi

\ifnum#1=3
\draw[line width = 3pt]
([xshift=3.5cm,yshift=-2.5cm]current page.north west)
rectangle
([xshift=-2cm,yshift=2.5cm]current page.south east);
\fi
\end{tikzpicture}
}

\newcommand{\frontmatterthesisinfo}[2]{
\ifnum#1=0
#2
\fi

\ifnum#1=1
\begin{centerboxed}
\centering
\vspace*{3mm}
\fontsize{14}{16}\selectfont Đại học Quốc gia Hà Nội \\
\fontsize{14}{16}\selectfont Trường Đại học Khoa học Tự nhiên \\
\fontsize{13}{16}\selectfont\textbf{Khoa Toán - Cơ - Tin học} \\
\fontsize{8}{16}\Pisymbol{dingbat}{69} \hspace{1.4cm}  \Huge\usym{1F56E} \hspace{1cm} \fontsize{8}{16}\Pisymbol{dingbat}{70}\\
\vspace*{1.5cm}
\includegraphics[height=3cm,keepaspectratio]{"logo/logo.jpg"}\\
\vspace*{1.5cm}
\fontsize{18}{1}\selectfont \textbf{Phương pháp rời rạc động giải các
bài toán \\ tìm đường đi có yếu tố thời gian} \\
\vspace{2cm}
{\fontsize{14}{1}\selectfont Khóa luận tốt nghiệp}  \\
{\fontsize{14}{1}\selectfont Khóa luận tốt nghiệp đại học hệ chính
quy}  \\
{\fontsize{14}{1}\selectfont Ngành: Khoa học máy tính và thông tin}  \\
\vspace{2cm}
{\fontsize{14}{1}\selectfont\textbf{
\begin{tabular}{ll}
Người hướng dẫn:  & TS. Vũ Đức Minh
\end{tabular}
}}
\\
\vspace{2cm}
\raggedright{\hspace{4.2cm}\fontsize{14}{1}\selectfont \textbf{Người thực hiện:}\\
\vspace{0.5cm}\hspace{5.5cm}
\begin{tabular}{ll}
Bùi Khánh Duy &  \\ \\[0.25em] 
\end{tabular}
}
\vfill
\centering
\fontsize{14}{14}\selectfont{\textbf{Hà Nội - 2024}}
\end{centerboxed}
\fi

\ifnum#1=2
\begin{centerboxed}
\centering
\vspace*{3mm}
{\fontsize{13}{1}\selectfont Đại học Quốc gia Hà Nội \\
Trường Đại học Khoa học Tự nhiên \\
\textbf{Khoa Toán - Cơ - Tin học}
}\\
\vspace{3.5cm}
{\fontsize{14}{1}\selectfont \textbf{
\begin{tabular}{ll}
Bùi Khánh Duy \\ \\[0.25em] 
\end{tabular}
}}
\\
\vspace{2cm}

{\fontsize{18}{1}\selectfont \textbf{Phương pháp rời rạc động giải các
bài toán \\ tìm đường đi có yếu tố thời gian} }
\\\vspace{5cm}

{\fontsize{14}{1}\selectfont Khóa luận tốt nghiệp}  \\
{\fontsize{14}{1}\selectfont Ngành: Khoa học máy tính và thông tin}  \\

\vfill
\centering
\fontsize{14}{14}\selectfont{\textbf{Hà Nội - 2024}}
\end{centerboxed}
\fi

\ifnum#1=3
\begin{centerboxed}
\centering
\vspace*{3mm}
{\fontsize{13}{1}\selectfont Đại học Quốc gia Hà Nội \\
Trường Đại học Khoa học Tự nhiên \\
\textbf{Khoa Toán - Cơ - Tin học}
}\\
\vspace{3.5cm}
{\fontsize{14}{1}\selectfont \textbf{
\begin{tabular}{ll}
Bùi Khánh Duy \\ \\[0.25em] 
\end{tabular}
}}
\\
\vspace{2cm}

{\fontsize{18}{1}\selectfont \textbf{Phương pháp rời rạc động giải các
bài toán \\ tìm đường đi có yếu tố thời gian} }
\\\vspace{5cm}

{\fontsize{14}{1}\selectfont Khóa luận tốt nghiệp}  \\
{\fontsize{14}{1}\selectfont Ngành: Khoa học máy tính và thông tin}  \\

\vspace{2cm}
{\fontsize{14}{1}\selectfont \textbf{
\begin{tabular}{ll}
Cán bộ hướng dẫn:  & TS. Vũ Đức Minh
\end{tabular}
}}
\vfill
\centering
\fontsize{14}{14}\selectfont{\textbf{Hà Nội - 2024}}
\end{centerboxed}
\fi

}
% fix toc use san serif font in header
\setkomafont{chapter}{\normalfont\bfseries\large}
\RedeclareSectionCommands[
tocentryformat=\usekomafont{chapter},
tocpagenumberformat=\usekomafont{chapter}
]{chapter}

% DOCUMENT

\begin{document}
\frontmatter
\pagestyle{empty}
\begin{titlepage}
\frontmatterthesisframe{2}{}
\frontmatterthesisinfo{2}{}
\end{titlepage}

\begin{titlepage}
\frontmatterthesisframe{2}{}
\frontmatterthesisinfo{3}{}
\end{titlepage}

\mainmatter
\pagestyle{fancy}
\chapter*{Lời mở đầu}\label{lux1eddi-mux1edf-ux111ux1ea7u}
\addcontentsline{toc}{chapter}{Lời mở đầu}

\markboth{Lời mở đầu}{Lời mở đầu}

Tui xin tự cảm ơn tui vì lười gõ latex mà lại chăm ngồi code latex để đẻ
ra con này

\begin{sign}

Bùi Khánh Duy

\end{sign}

\toc

\subfile{sections/0.Introduce}%
\subfile{sections/1.Description}%
\subfile{sections/2.MDP}%
\subfile{sections/3.MTTP}%
\subfile{sections/4.Computational}%
\subfile{sections/5.CaseStudy}%

\printbibliography

\backmatter
\end{document}
% END DOCUMENT